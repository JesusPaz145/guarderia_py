{% extends "layouts/base.html" %}

{% block title %}Resumen Semanal - Guarder&iacute;a{% endblock %}
{% block header_title %}Resumen Semanal{% endblock %}

{% block content %}
<div class="flex items-center justify-between mb-8">
  <a href="{{ url_for('resumen_semanal', date=prev_week_start_str) }}" class="bg-pink-500 hover:bg-pink-600 text-white p-3 rounded-full shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300">
    <i class="fas fa-chevron-left text-xl"></i>
  </a>
  <div class="text-center">
    <h1 class="text-4xl font-extrabold text-pink-700 tracking-tight drop-shadow-sm">Resumen Semanal</h1>
    <p class="text-lg text-pink-500 mt-2">{{ week_start_str }} - {{ week_end_str }}</p>
  </div>
  <a href="{{ url_for('resumen_semanal', date=next_week_start_str) }}" class="bg-pink-500 hover:bg-pink-600 text-white p-3 rounded-full shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300">
    <i class="fas fa-chevron-right text-xl"></i>
  </a>
</div>

<div class="grid grid-cols-1 gap-6">
  <section class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-6 border border-pink-100">
    <h2 class="text-2xl font-semibold text-pink-700 mb-4">
      <i class="fas fa-baby mr-2"></i>
      Ni&ntilde;os
    </h2>
    {% if children_weekly_summary %}
      <div class="space-y-3">
        {% for child in children_weekly_summary %}
        <div class="border border-pink-200 rounded-xl overflow-hidden">
          <button type="button" class="child-toggle w-full flex items-center justify-between px-4 py-3 bg-pink-50 hover:bg-pink-100 transition-colors" data-target="child-{{ child.id }}">
            <span class="font-semibold text-pink-800">{{ child.nombre }}</span>
            <span class="font-bold text-pink-700">${{ "%.2f"|format(child.total) }}</span>
          </button>
          <div id="child-{{ child.id }}" class="hidden px-4 py-3 bg-white">
            <div class="space-y-2">
              {% for day in child.daily %}
              <div class="flex items-center justify-between text-sm">
                <span class="text-gray-600">{{ day.label }}</span>
                <span class="font-medium text-gray-800">${{ "%.2f"|format(day.amount) }}</span>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-pink-500">No hay registros de ni&ntilde;os en esta semana.</p>
    {% endif %}
  </section>

  <section class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg p-6 border border-pink-100">
    <h2 class="text-2xl font-semibold text-pink-700 mb-4">
      <i class="fas fa-user-tie mr-2"></i>
      Empleadas
    </h2>
    {% if week_employees_earnings %}
      <div class="space-y-3">
        {% for employee in week_employees_earnings %}
        <div class="flex items-center justify-between p-4 bg-pink-50 border border-pink-200 rounded-xl">
          <span class="font-semibold text-pink-800">{{ employee.nombre }}</span>
          <span class="font-bold text-pink-700">${{ "%.2f"|format(employee.total_ganancia) }}</span>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-pink-500">No hay registros de empleadas en esta semana.</p>
    {% endif %}
  </section>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.querySelectorAll('.child-toggle').forEach((btn) => {
    btn.addEventListener('click', () => {
      const targetId = btn.getAttribute('data-target');
      const panel = document.getElementById(targetId);
      panel.classList.toggle('hidden');
    });
  });
</script>
{% endblock %}

